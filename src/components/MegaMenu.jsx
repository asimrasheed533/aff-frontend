import { useEffect, useState } from "react";

import ClickAwayListener from "react-click-away-listener";
import MegaMenuContent from "./MegaMenuContent";
import MegaMenuList from "./MegaMenuList";

export default function MegaMenu({ onClickAway, data }) {
  const [show, setShow] = useState(data[0]?.title);

  useEffect(() => {
    setShow(data[0]?.title);
  }, [data]);

  return (
    <ClickAwayListener onClickAway={onClickAway}>
      <div className="megamenu">
        <div className="megamenu__content">
          <div className="megamenu__content__column">
            <ul className="megamenu__content__column__list">
              {data?.map((item) => (
                <li
                  key={item?.title}
                  className={`megamenu__content__column__list__item ${
                    item?.title === show &&
                    "megamenu__content__column__list__item__active"
                  }`}
                  onMouseOver={() => setShow(item?.title)}
                >
                  <a className="megamenu__content__column__list__item__link">
                    {item?.title}
                  </a>
                  {item?.list && (
                    <span style={{ marginLeft: "3em" }}>
                      <svg
                        width="9"
                        height="15"
                        viewBox="0 0 9 15"
                        fill="currentColor"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M2.56077 0.995288L2.56087 0.995363C2.61173 1.03277 2.67245 1.09211 2.71236 1.13131C2.76438 1.18241 2.83058 1.24938 2.90773 1.32865C3.06245 1.4876 3.26819 1.70312 3.50657 1.9553C3.98371 2.46007 4.59641 3.11677 5.20342 3.77273C5.81041 4.42867 6.41286 5.08511 6.86945 5.58938C7.09751 5.84126 7.29052 6.05664 7.42989 6.21551C7.49927 6.2946 7.55747 6.36209 7.60074 6.41409C7.6221 6.43976 7.64251 6.46487 7.65976 6.48735C7.66005 6.48773 7.66045 6.48825 7.66097 6.48891C7.66953 6.49993 7.70804 6.54948 7.73582 6.60737L2.56077 0.995288ZM2.56077 0.995288C2.31132 0.811899 2.03935 0.783016 1.75848 0.792108C1.62071 0.796568 1.44238 0.803186 1.27127 0.875248C1.0895 0.951801 0.967255 1.07943 0.878975 1.17362C0.78897 1.26964 0.687837 1.38832 0.623408 1.5432C0.555032 1.70757 0.548232 1.86231 0.552453 1.9927C0.55259 1.9969 0.552584 2.00102 0.552377 2.01741L0.552351 2.01942C0.552171 2.0331 0.55179 2.06216 0.553613 2.09413C0.558403 2.17812 0.576708 2.26567 0.618904 2.36032C0.684854 2.50824 0.807932 2.66316 0.970314 2.85197C1.2747 3.20588 1.87811 3.85465 3.06296 5.12855C3.22619 5.30405 3.40046 5.49141 3.5865 5.6915L3.58651 5.69151M2.56077 0.995288L3.58651 5.69151M3.58651 5.69151C4.07771 6.21979 4.52396 6.70385 4.84707 7.05798C4.94041 7.16028 5.02314 7.25137 5.0935 7.32931C5.00092 7.44611 4.88513 7.59115 4.75022 7.7593C4.37926 8.22165 3.86687 8.85486 3.30273 9.54715C2.18153 10.923 1.19067 12.1456 1.11594 12.2472L1.11592 12.2472M3.58651 5.69151L1.11592 12.2472M1.11592 12.2472C0.753534 12.7399 0.868534 13.3602 1.28615 13.7516C1.38034 13.8399 1.51058 13.9593 1.69693 14.024M1.11592 12.2472L1.69693 14.024M1.69693 14.024C1.87233 14.0848 2.05072 14.0799 2.18849 14.0754M1.69693 14.024L2.18849 14.0754M2.18849 14.0754C2.46795 14.0664 2.73862 14.0203 2.97528 13.8213L2.18849 14.0754ZM2.97533 13.8213C3.02365 13.7807 3.08043 13.7174 3.11733 13.6761C3.16575 13.6219 3.22732 13.5509 3.29906 13.4668C3.44293 13.2984 3.63414 13.07 3.85564 12.8029C4.29899 12.2682 4.86806 11.5729 5.43163 10.8786C5.99518 10.1843 6.55428 9.4897 6.97763 8.95659C7.18909 8.69029 7.36791 8.46276 7.49681 8.29516C7.56099 8.21171 7.61472 8.14063 7.65454 8.08601C7.6742 8.05904 7.69291 8.03275 7.70864 8.00932C7.7089 8.00892 7.70928 8.00837 7.70975 8.00768C7.71758 7.99616 7.75251 7.94476 7.77645 7.88592C7.77647 7.88586 7.77649 7.88581 7.77652 7.88575L7.30769 7.69527C7.34468 7.60434 7.37096 7.40808 7.36614 7.2592C7.36132 7.11031 7.32238 6.9155 7.27956 6.82626L7.73584 6.60742L2.97533 13.8213Z"
                          fill="white"
                          stroke="white"
                          strokeWidth="1.01208"
                        />
                      </svg>
                    </span>
                  )}
                </li>
              ))}
            </ul>
          </div>
          {data.find((item) => item?.title === show)?.list ? (
            <MegaMenuList
              data={data.find((item) => item?.title === show)?.list}
              onClickAway={onClickAway}
            />
          ) : (
            <MegaMenuContent
              data={data.find((item) => item?.title === show)}
              onClickAway={onClickAway}
            />
          )}
        </div>
      </div>
    </ClickAwayListener>
  );
}
